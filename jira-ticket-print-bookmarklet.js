javascript:void(function(){String.prototype.truncate=function(c){var d=this.length,e="…",b=e.length,a=this;if(d>c){a=this.substr(0,(c-b))+e}return a};String.prototype.trimWhitespace=function(){return this.replace(/\s+/g," ").split(/\n/).join(" ")};var xing=xing||{};xing.jira=xing.jira||{};xing.jira.DataCollector=(function(f,g){function d(h){return h.split(/,/)}function b(){var h=localStorage.getItem(e.TICKET_KEY),i=h&&h[0]?JSON.parse(h):[];return i}var a=f("#greenhopper-agile-issue-web-panel dd a"),c=location.hostname,e={COLLABORATOR_KEY:c+".collaborators",TICKET_KEY:c+"ticket",observers:[],data:{},subscribe:function(h){this.observers.push(h)},unsubscribe:function(i){var h=this.observer.indexOf(i);if(h>=0){this.observers.splice(h)}},update:function(h){this.data=f.extend(this.data,h||{});this.observers.forEach(function(i){i.update()})},storeTicket:function(j){var h=b(),i=h.concat([j]);localStorage.setItem(e.TICKET_KEY,JSON.stringify(i))},getStoredTickets:function(){return b()},removeStoredTickets:function(i){if(i!==g){var h=b();if(h[0]){h.splice(i,1);localStorage.setItem(e.TICKET_KEY,JSON.stringify(h))}}else{localStorage.removeItem(e.TICKET_KEY)}return b()},addCollaborators:function(){var i=localStorage.getItem(e.COLLABORATOR_KEY)||"",h=window.prompt('Please enter your collaborators!\nNote: Separate the names with a comma e.g. "Jeffrey, Walter"',i||"");if(!!h&&i!==h){localStorage.setItem(this.COLLABORATOR_KEY,h);this.update({collaborators:d(h)})}},getCollaborators:function(){var h=localStorage.getItem(e.COLLABORATOR_KEY)||"";return d(h)},getDate:function(j){var k=j.attr("datetime"),i,h,n,l,o;if(k){i=new Date(k);h=i.getMonth()+1;h=h>9?h:"0"+h;n=i.getFullYear();l=i.getDate();o=(n+"-"+h+"-"+l);return o}return""}};e.update({number:f("#key-val").text()||"",description:f("#description-val").text()||"",dueDate:e.getDate(f("#due-date time")),collaborators:e.getCollaborators(),type:f("#type-val img").attr("alt")||"",reporter:f("#reporter-val span").text()||"",created:e.getDate(f("#create-date time")),title:f("#summary-val").text()||"",component:f("#components-field").text()||"",target:a[0]?a.text().trimWhitespace():""});return e}(jQuery));var xing=xing||{};xing.jira=xing.jira||{};xing.jira.tableFormat=function(a){return[[{head:true,cell:{options:{cssClass:"gm-number gm-center gm-20"},body:{text:a.number.replace(/-/,"<br>"),options:{cssClass:"h1",title:a.number}}}},{head:true,cell:{options:{colspan:4,cssClass:"gm-title"},body:{text:a.title.truncate(74),options:{cssClass:"h2 gm-hyphen"}}}}],[{cell:{options:{rowspan:1,cssClass:(a.dueDate?"gm-warning":"")},title:{text:"Due date"},body:{options:{cssClass:"h4"},text:a.dueDate}}},{cell:{options:{colspan:4,cssClass:"gm-pairing"},title:{text:"Pairing",options:{cssClass:"gm-snap-left h5"}},body:{text:a.collaborators.join(" ")+'<button id="gm-add-collaborator">Add Collaborators</button>',options:{cssClass:"gm-snap-left h5"}}}}],[{cell:{title:{text:"Type"},body:{text:a.type}}},{cell:{options:{rowspan:4,colspan:4,cssClass:"gm-desc gm-hyphen"}}}],[{cell:{title:{text:"Reporter"},body:{text:a.reporter}}}],[{cell:{title:{text:"Component"},body:{text:a.component}}}],[{cell:{title:{text:"Target"},body:{text:a.target}}}],[{cell:{title:{text:"Created"},body:{text:a.created}}},{cell:{options:{cssClass:"gm-date-content"},title:{text:"Start Progress"},body:{text:"Day | Time"}}},{cell:{options:{cssClass:"gm-date-content"},title:{text:"End date"},body:{text:"Day | Time"}}},{cell:{options:{cssClass:"gm-qa"},title:{text:"QA passed"},body:{text:""}}},{cell:{title:{text:"Release"}}}]]};var xing=xing||{};xing.jira=xing.jira||{};xing.jira.TableBuilder=(function(c){function d(e){return"text" in e?e.text:""}function b(f,h){h=" "+(h||"");var j=f.options||{},g="cssClass" in j?j.cssClass:"",i="",k;c.extend(j,{cssClass:g+h});if(j.cssClass===" "){delete j.cssClass}for(k in j){var e=k==="cssClass"?"class":k,l=j[k]||"";e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();i+=" "+e+'="'+l+'"'}return i}var a={row:function(f,g){var e="";c(g).each(function(i,h){e+=a.cell(h)});return"<tr"+b(g)+">"+e+"</tr>"},cell:function(h){var g=h.cell,f="",e=h.head?"th":"td";f+=a.cellTitle(g);f+=a.cellBody(g);return"<"+e+b(g)+'><div class="gm-inner">'+f+"</div></"+e+">"},cellBody:function(g){var f="";if("body" in g){var e=g.body;f+="<div"+b(e,"gm-bd")+">"+d(e)+"</div>"}return f},cellTitle:function(f){var e="";if("title" in f){var g=f.title;e+="<div"+b(g,"gm-hd")+">"+d(g)+"</div>"}return e},build:function(f){var e="";c(f).each(function(g,h){e+=a.row(g,h)});return'<table class="gm-table">'+e+"</table>"}};return a}(jQuery));var xing=xing||{};xing.jira=xing.jira||{};xing.jira.Application=(function(f){function e(i){var h=f(i.target),j=h.hasClass("gm-container")&&h||h.parents(".gm-container");if(!j[0]){a()}}function a(){f("#gm-popup").remove();f(document).unbind("click",e)}function c(){if(f(".gm-show-popup")[0]){return false}var j=f('<li class="toolbar-item"></li>'),i=f('<a href="#print" class="gm-show-popup toolbar-trigger">Print Card</a>'),h=f(".toolbar-group");f(h[h.length-1]).append(j.append(i));i.bind("click",function(k){k.preventDefault();b.showPopup();setTimeout(function(){f(document).click(e)},1)})}function d(i,k){var m=f(i),l=m.find(".gm-number .gm-bd").attr("title"),h=k?"":" gm-remove-ticket",j=k?"New ticket":"Delete ticket";return'<li><a href="#" class="gm-ticket-section'+h+'" title="'+j+": "+l+'"></a></li>'}function g(h){f("#gm-popup").remove();var i=xing.jira.TableBuilder,m=xing.jira.tableFormat(xing.jira.DataCollector.data),j="",k=i.build(m),l="";l="";h.forEach(function(n){l+=d(n)});l+=d(k,true);l='<div class="gm-printable-tickets"><span class="gm-printable-tickets-label">Selected Ticket: </span><ul>'+l+"</ul></div>";h.forEach(function(n){if(n!==k){j+=n}});f("body").append(f('<div id="gm-popup"><div class="gm-container aui-popup box-shadow"><h2 class="aui-popup-heading">Print preview</h2><div class="aui-popup-content"><div class="form-body">'+j+k+'</div><div class="buttons-container form-footer"><div class="gm-60 gm-grid-item">'+l+'</div><div class="buttons gm-40 gm-grid-item"><button class="gm-pick-more aui-button"><i>+</i> Select another</button>&nbsp;<button class="gm-print aui-button">Print</button><a class="gm-cancel cancel" href="#">Cancel</a></div></div></div></div><div class="aui-blanket"></div></div>'))}var b={addStyle:function(i){var h,j=document.getElementById("gm-style");h=document.getElementsByTagName("head")[0];if(!j){if(!h){return}j=document.createElement("style");j.setAttribute("id","gm-style");j.type="text/css";j.media="screen,print";h.appendChild(j)}j.innerHTML+=i+"\n"},showPopup:function(){var h=xing.jira.DataCollector;if(f("#gm-popup")[0]){return}h.subscribe(this);g(h.getStoredTickets());f("body").on("click",".gm-print",function(i){i.preventDefault();window.print();h.removeStoredTickets();a()}).on("click",".gm-pick-more",function(j){j.preventDefault();var i=f("#gm-popup .gm-table:last")[0].outerHTML;h.storeTicket(i.trimWhitespace());a()}).on("click",".gm-cancel",function(i){i.preventDefault();a()}).on("click",".gm-remove-ticket",function(k){k.preventDefault();var i=f(k.target).parent(),j=i.index(i);h.removeStoredTickets(j);f("#gm-popup .form-body table").eq(j).remove();g(h.getStoredTickets())}).on("click","#gm-add-collaborator",function(){h.addCollaborators()})},update:function(){g(xing.jira.DataCollector.getStoredTickets())},init:function(h){b.addStyle(h);c()}};return b}(jQuery));;xing.jira.Application.init('.gm-table{border-collapse:collapse;font:10pt helvetica,arial,sans-serif;background-color:#FFF;width:100%;padding-bottom:2mm}.gm-table,.gm-table th,.gm-table td{border:1px solid #DDD}.gm-table td{vertical-align:top}.gm-pick-more i{font-size:1.4em;font-style:normal;font-weight:bold;line-height:0}.gm-hd{color:#999;font-size:.8em;line-height:1.4em;text-transform:uppercase;text-align:left}.h1{font-size:3em}.h2{font-size:2.4em}.h4{font-size:1.4em;line-height:1.5em}.h5{font-size:.8em;line-height:1.4em}.gm-snap-left{float:left}.gm-grid-item{display:inline-block}.gm-10{width:10%}.gm-20{width:20%}.gm-40{width:40%}.gm-60{width:60%}.gm-printable-tickets ul{padding:0}.gm-printable-tickets-label{float:left;padding-right:5px;padding-top:3px}.gm-printable-tickets li{list-style:none;display:block;margin-right:2px;line-height:0;width:12px;height:8px;padding:1px 1px 1px 3px;float:left;background-color:#bbb}.gm-printable-tickets li:nth-child(2n+1){border-bottom:0}.gm-printable-tickets li:nth-child(2n){border-top:0;left:-18px;margin-right:-13px;position:relative;top:10px}.gm-printable-tickets li:nth-child(2n+1):last-child{height:18px}.gm-printable-tickets li:nth-child(2n+1):after{color:black;content:"";display:list-item;font-weight:bold;left:19px;list-style-position:outside;list-style-type:decimal;opacity:.3;position:relative;top:-7px;z-index:1;pointer-events:none}.gm-ticket-section{display:inline-block;line-height:0;background-color:#f2f88d;text-indent:-99em;overflow:hidden;position:relative;width:12px;height:8px}.gm-remove-ticket{background-color:white}.gm-remove-ticket:hover{background-color:#e94902}.gm-remove-ticket:hover:after{content:"✖";color:white;display:inline-block;height:100%;line-height:.5em;position:absolute;top:0;left:0;text-align:center;text-indent:10%;width:100%}.gm-center{text-align:center}.gm-left{text-align:left}.gm-title .gm-inner{overflow:hidden;padding-bottom:0}.gm-hyphen{-wekit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;-o-hyphens:auto;hyphens:auto}.gm-inner{padding:2mm 3mm}.gm-desc .gm-inner{overflow:hidden;padding-bottom:0}.gm-number .gm-bd{word-break:break-all}.gm-pairing .gm-inner{overflow:hidden}.gm-pairing .gm-hd{padding-right:3mm}.gm-pairing .gm-bd{overflow:hidden}.gm-qa .gm-bd{border:1px solid #DDD;-webkit-border-radius:2em;-moz-border-radius:2em;-ms-border-radius:2em;-o-border-radius:2em;border-radius:2em;height:40px;margin:auto;width:40px}.gm-warning{background-color:#e94902;color:white}.gm-warning .gm-hd{color:white}.gm-date-content .gm-hd{padding:0 0 1px;text-align:center}.gm-date-content .gm-bd{color:#DDD;font-size:.7em;text-align:center;text-transform:uppercase}.gm-container .gm-print{margin:0 10px 0 0}@media print{html,body{background-color:white}.gm-hd{color:#999}#page,.aui-blanket,.gm-container .form-footer,.gm-container .aui-popup-heading,#gm-add-collaborator{display:none}.gm-container{-webkit-box-shadow:none!important;-moz-box-shadow:none!important;-ms-box-shadow:none!important;-o-box-shadow:none!important;box-shadow:none!important;left:0;margin:0;padding:0;position:absolute;top:0;width:100%;z-index:2501}.gm-container .form-body{padding:0!important}.gm-table:nth-child(2n){margin-top:2.75cm}}@media screen{.form-body{height:460px}.gm-container{left:50%;margin-left:-9cm;margin-top:5%;top:0;width:18.9cm}.gm-container .form-body{padding:2mm!important}.gm-table:nth-child(2n){margin-top:2mm;margin-bottom:2mm}}');xing.jira.Application.showPopup()})();