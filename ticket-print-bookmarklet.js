javascript:void(function(){String.prototype.truncate=function(c){var d=this.length,e="…",b=e.length,a=this;if(d>c){a=this.substr(0,(c-b))+e}return a};String.prototype.trimWhitespace=function(){return this.replace(/\s+/g," ").split(/\n/).join(" ")};String.prototype.trimToCSSSelector=function(){return this.toLowerCase().replace(/ /g,"-")};var xing=xing||{};xing.jira=xing.jira||{};xing.jira.DataCollector=(function(f,h){function d(i){return i.split(/,/)}function b(){var i=localStorage.getItem(e.TICKET_KEY),j=i&&i[0]?JSON.parse(i):[];return j}var a=f("#greenhopper-agile-issue-web-panel dd a"),c=location.hostname,g=c?".":"",e={COLLABORATOR_KEY:c+g+"collaborators",TICKET_KEY:c+g+"ticket",observers:[],data:{},subscribe:function(i){this.observers.push(i)},unsubscribe:function(j){var i=this.observer.indexOf(j);if(i>=0){this.observers.splice(i)}},update:function(i){this.data=f.extend(this.data,i||{});this.observers.forEach(function(j){j.update()})},storeTicket:function(k){var i=b(),j=i.concat([k]);localStorage.setItem(e.TICKET_KEY,JSON.stringify(j))},getStoredTickets:function(){return b()},removeStoredTickets:function(j){if(j!==h){var i=b();if(i[0]){i.splice(j,1);localStorage.setItem(e.TICKET_KEY,JSON.stringify(i))}}else{localStorage.removeItem(e.TICKET_KEY)}return b()},addCollaborators:function(){var j=localStorage.getItem(e.COLLABORATOR_KEY)||"",i=window.prompt('Please enter your collaborators!\nNote: Separate the names with a comma e.g. "Jeffrey, Walter"',j||"");if(!!i&&j!==i){localStorage.setItem(this.COLLABORATOR_KEY,i);this.update({collaborators:d(i)})}},getCollaborators:function(){var i=localStorage.getItem(e.COLLABORATOR_KEY)||"";return d(i)},getDate:function(k){var l=k.attr("datetime"),j,i,o,n,p;if(l){j=new Date(l);i=j.getMonth()+1;i=i>9?i:"0"+i;o=j.getFullYear();n=j.getDate();p=(o+"-"+i+"-"+n);return p}return""}};e.update({number:f("#key-val").text()||"",description:f("#description-val").text()||"",dueDate:e.getDate(f("#due-date time")),collaborators:e.getCollaborators(),type:f("#type-val img").attr("alt")||"",reporter:f("#reporter-val span").text()||"",created:e.getDate(f("#create-date time")),title:f("#summary-val").text()||"",component:f("#components-field").text()||"",target:a[0]?a.text().trimWhitespace():""});return e}(jQuery));var xing=xing||{};xing.jira=xing.jira||{};xing.jira.tableFormat=function(b){var a=5;return[[{head:true,cell:{options:{colspan:2,cssClass:"gm-number gm-ltr"},body:{text:b.number,options:{cssClass:"h1",title:b.number}}}},{cell:{title:{text:"Type"},body:{options:{cssClass:"gm-label gm-label-"+b.type.trimToCSSSelector()},text:b.type}}},{cell:{title:{text:"Component"},body:{text:b.component}}},{cell:{title:{text:"Target"},body:{text:b.target}}}],[{head:true,cell:{options:{colspan:a,cssClass:"gm-title gm-ltr"},body:{text:b.title.truncate(220),options:{cssClass:"h2 gm-hyphen"}}}}],[{cell:{options:{colspan:a,cssClass:"gm-pairing"},title:{text:"Pairing",options:{cssClass:"gm-snap-left h5"}},body:{text:b.collaborators.join(" ")+'<button id="gm-add-collaborator" class="aui-button gm-snap-right"><i>+</i> Add Collaborators</button>',options:{cssClass:"h5"}}}}],[{cell:{title:{text:"Created"},body:{text:b.created}}},{cell:{title:{text:"Due date"},body:{options:{cssClass:(b.dueDate?"gm-label-danger gm-label":"")},text:b.dueDate}}},{cell:{title:{text:"Reporter"},body:{text:b.reporter}}},{cell:{options:{cssClass:"gm-date-content gm-20"},title:{text:"Start Progress"},body:{text:"Day | Time"}}},{cell:{options:{cssClass:"gm-date-content gm-20"},title:{text:"End date"},body:{text:"Day | Time"}}}]]};var xing=xing||{};xing.jira=xing.jira||{};xing.jira.TableBuilder=(function(c){function d(e){return"text" in e?e.text:""}function b(f,h){h=" "+(h||"");var j=f.options||{},g="cssClass" in j?j.cssClass:"",i="",k;c.extend(j,{cssClass:g+h});if(j.cssClass===" "){delete j.cssClass}for(k in j){var e=k==="cssClass"?"class":k,l=j[k]||"";e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();i+=" "+e+'="'+l+'"'}return i}var a={row:function(f,g){var e="";c(g).each(function(i,h){e+=a.cell(h)});return"<tr"+b(g)+">"+e+"</tr>"},cell:function(h){var g=h.cell,f="",e=h.head?"th":"td";f+=a.cellTitle(g);f+=a.cellBody(g);return"<"+e+b(g)+'><div class="gm-inner">'+f+"</div></"+e+">"},cellBody:function(g){var f="";if("body" in g){var e=g.body;f+="<div"+b(e,"gm-bd")+">"+d(e)+"</div>"}return f},cellTitle:function(f){var e="";if("title" in f){var g=f.title;e+="<div"+b(g,"gm-hd")+">"+d(g)+"</div>"}return e},build:function(f){var e="";c(f).each(function(g,h){e+=a.row(g,h)});return'<table class="gm-table">'+e+"</table>"}};return a}(jQuery));var xing=xing||{};xing.jira=xing.jira||{};xing.jira.Application=(function(g){function f(j){var i=g(j.target),k=i.hasClass("gm-container")&&i||i.parents(".gm-container");if(!k[0]){b()}}function b(){g("#gm-popup").remove();g(document).unbind("click",f)}function d(){if(g(".gm-show-popup")[0]){return false}var k=g('<li class="toolbar-item"></li>'),j=g('<a href="#print" class="gm-show-popup toolbar-trigger">Print Card</a>'),i=g(".toolbar-group");g(i[i.length-1]).append(k.append(j));j.bind("click",function(l){l.preventDefault();c.showPopup();setTimeout(function(){g(document).click(f)},1)})}function e(j,l){var n=g(j),m=n.find(".gm-number .gm-bd").attr("title"),i=l?"":" gm-remove-ticket",k=l?"New ticket":"Delete ticket";return'<li><a href="#" class="gm-ticket-section'+i+'" title="'+k+": "+m+'"></a></li>'}function h(i){g("#gm-popup").remove();var j=xing.jira.TableBuilder,n=xing.jira.tableFormat(xing.jira.DataCollector.data),k="",l=j.build(n),m="";m="";i.forEach(function(o){if(g(o).find(".gm-number").text()!==g(l).find(".gm-number").text()){k+="<li>"+o+"</li>";m+=e(o)}});m+=e(l,true);m='<div class="gm-tickets-pagination"><span class="gm-tickets-pagination-label">Selected Ticket: </span><ul>'+m+"</ul></div>";g("body").append(g('<div id="gm-popup"><div class="gm-container aui-popup box-shadow"><h2 class="aui-popup-heading">Print preview</h2><div class="aui-popup-content"><div class="form-body"><ul class="gm-output-list">'+k+"<li>"+l+'</li></ul></div><div class="buttons-container form-footer"><div class="gm-60 gm-grid-item">'+m+'</div><div class="buttons gm-40 gm-grid-item"><label for="gm-select-ticket">Select another:</label>&nbsp;<button id="gm-select-ticket" class="gm-pick-more aui-button"><i>+</i></button>&nbsp;<button class="gm-print aui-button">Print</button><a class="gm-cancel cancel" href="#">Cancel</a></div></div></div></div><div class="aui-blanket"></div></div>'))}var a=xing.jira.DataCollector,c={addStyle:function(j){var i,k=document.getElementById("gm-style");i=document.getElementsByTagName("head")[0];if(!k){if(!i){return}k=document.createElement("style");k.setAttribute("id","gm-style");k.type="text/css";k.media="screen,print";i.appendChild(k)}k.innerHTML+=j+"\n"},storeTicketHandler:function(){c.update();var j=g("#gm-popup .gm-table:last"),i="";i=j[0].outerHTML;a.storeTicket(i.trimWhitespace());b();g(".aui-message").remove();AJS.messages.success("#header .global .primary",{title:"Ticket print",body:"Ticket is stored! Please navigate to another if you want print one ticket more."});setTimeout(function(){g(".aui-message").remove()},5000)},showPopup:function(){if(g("#gm-popup")[0]){return}a.subscribe(this);h(a.getStoredTickets());g("body").on("click",".gm-print",function(i){i.preventDefault();window.print();a.removeStoredTickets();b()}).on("click",".gm-pick-more",function(i){i.preventDefault();c.storeTicketHandler()}).on("click",".gm-cancel",function(i){i.preventDefault();b()}).on("click",".gm-remove-ticket",function(k){k.preventDefault();var i=g(k.target).parent(),j=i.index(i);a.removeStoredTickets(j);g("#gm-popup .form-body table").eq(j).remove();h(a.getStoredTickets())}).on("click","#gm-add-collaborator",function(){a.addCollaborators()})},update:function(){h(a.getStoredTickets())},init:function(i){c.addStyle(i);d()}};return c}(jQuery));xing.jira.Application.init('.gm-table{border-collapse:collapse;font:10pt helvetica,arial,sans-serif;padding-bottom:2mm;width:100%}.gm-table,.gm-table th,.gm-table td{border:1px solid #DDD}.gm-table td{vertical-align:top}.gm-pick-more i{font-size:1.4em;font-style:normal;font-weight:bold;line-height:0}.gm-hd{color:#999;font-size:.8em;line-height:1.4em;text-align:left;text-transform:uppercase}.gm-ltr{text-align:left}.h1{font-size:3em}.h2{font-size:2.4em}.h4{font-size:1.4em;line-height:1.5em}.h5{font-size:.8em;line-height:1.4em}.gm-snap-left{float:left}.gm-snap-right{float:right}.gm-grid-item{display:inline-block}.gm-10{width:10%}.gm-20{width:20%}.gm-40{width:40%}.gm-60{width:60%}.gm-tickets-pagination ul{padding:0}.gm-tickets-pagination-label{float:left;padding-right:5px;padding-top:3px}.gm-tickets-pagination li{background-color:#bbb;display:block;float:left;height:8px;line-height:0;list-style:none;margin-right:2px;padding:1px 1px 1px 3px;width:12px}.gm-tickets-pagination li:nth-child(2n+1){border-bottom:0}.gm-tickets-pagination li:nth-child(2n){border-top:0;left:-18px;margin-right:-13px;position:relative;top:10px}.gm-tickets-pagination li:nth-child(2n+1):last-child{height:18px}.gm-tickets-pagination li:nth-child(2n+1):after{color:black;content:"";display:list-item;font-weight:bold;left:19px;list-style-position:outside;list-style-type:decimal;opacity:.3;pointer-events:none;position:relative;top:-7px;z-index:1}.gm-label{background-color:#999;border-radius:.2em;color:white;display:inline-block;font-weight:bold;line-height:1em;padding:4px 8px 2px}.gm-label-danger{background-color:#c00}.gm-label-bug{background-color:#c00}.gm-label-user-story{background-color:#8caf68}.gm-ticket-section{background-color:#f2f88d;display:inline-block;height:8px;line-height:0;overflow:hidden;position:relative;text-indent:-99em;width:12px}.gm-remove-ticket{background-color:white}.gm-remove-ticket:hover{background-color:#e94902}.gm-remove-ticket:hover:after{color:white;content:"✖";display:inline-block;height:100%;left:0;line-height:.5em;position:absolute;text-align:center;text-indent:10%;top:0;width:100%}.gm-center{text-align:center}.gm-left{text-align:left}.gm-hyphen{hyphens:auto;-o-hyphens:auto;-ms-hyphens:auto;-moz-hyphens:auto;-wekit-hyphens:auto}.gm-inner{padding:2mm 3mm}.gm-title .gm-inner{overflow:hidden;padding-bottom:0}.gm-title .gm-inner{height:6.5cm}.gm-number .gm-bd{word-break:break-all}.gm-pairing .gm-inner{overflow:hidden}.gm-pairing .gm-hd{padding-right:3mm}.gm-pairing .gm-bd{overflow:hidden}.gm-qa .gm-bd{border-radius:2em;border:1px solid #DDD;height:40px;margin:auto;width:40px}.gm-output-list{margin:0;padding:0}.gm-output-list>li{-o-box-sizing:border-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;height:12.2cm;overflow:hidden}.gm-output-list>li:nth-child(2n){margin-top:5mm}.gm-warning{background-color:#e94902;color:white}.gm-warning .gm-hd{color:white}.gm-date-content .gm-hd{padding:0 0 1px;text-align:center}.gm-date-content .gm-bd{color:#DDD;font-size:.7em;text-align:center;text-transform:uppercase}.gm-date-content .gm-inner{min-height:1.2cm}.gm-container .gm-print{margin:0 10px 0 0}.global .aui-message{left:50%;margin-left:-220px;position:absolute;top:20px;z-index:101}@media print{html,body{background-color:white}#page,.aui-blanket,.gm-container .form-footer,.gm-container .aui-popup-heading,#gm-add-collaborator{display:none}.gm-container{box-shadow:none!important;left:0;margin:0;max-height:auto;padding:0;position:absolute;top:0;width:100%}.gm-container .form-body{padding:0!important}}@media screen{.form-body{height:460px}.gm-container{left:50%;margin-left:-9cm;margin-top:5%;top:0;width:18.9cm}.gm-container .form-body{padding:2mm!important}}');xing.jira.versionTimestamp=1377785237;xing.jira.Application.showPopup();})();